import{r as s,c as i,h as t,H as l}from"./p-d36259ec.js";let a=(s=21)=>{let i="",t=crypto.getRandomValues(new Uint8Array(s));for(;s--;){let l=63&t[s];i+=l<36?l.toString(36):l<62?(l-26).toString(36).toUpperCase():l<63?"_":"-"}return i};const e=class{constructor(t){s(this,t),this.saveItem=i(this,"saveItem",7),this.removeItem=i(this,"removeItem",7),this.itemSelected=i(this,"itemSelected",7),this.searchItem=i(this,"searchItem",7),this.pagination=i(this,"pagination",7),this.afterSave=i(this,"afterSave",7),this.changedOrder=i(this,"changedOrder",7),this.content=[],this.columns=[],this.filters=[],this.currentPage=1,this.pagesCount=1,this.hasSearch=!0,this.hasPagination=!0,this.allowSelect=!1,this.name="",this.loadingInputBlock=!1,this.striped=!1,this.hasUpdate=!0,this.hasCreate=!0,this.currentInputState="none",this.currentError="",this.orderDesc=!1,this.currentOrderBy="",this.filterModalVisible=!1,this.pendingRequest=!1,this.isSearching=!1,this.currentFormTransactionId=""}async componentWillUpdate(){this.resetSelectedItem()}async componentWillLoad(){this.resetTransactionId(),this.resetSelectedItem()}resetSelectedItem(){!(this.allowSelect&&this.content.length>0)||this.currentSelectedItem&&this.content.find((s=>s===this.currentSelectedItem))||(this.currentSelectedItem=this.content[0],this.itemSelected.emit(this.currentSelectedItem))}resetTransactionId(){this.currentFormTransactionId=a()}changeValueCurrentItem(s,i){const t=this.currentItem;t&&(t[s]=i,this.currentItem=t)}editItem(s){this.resetTransactionId(),this.currentItem=Object.assign({},s),this.currentInputState="edit"}createItem(){this.resetTransactionId(),this.currentItem={},this.currentInputState="create"}afterSuccessHandler(s){var i;this.resetTransactionId(),this.pendingRequest=!1,(null===(i=s.detail)||void 0===i?void 0:i.trim().length)>0?this.currentError=s.detail:this.currentInputState="none"}deleteItem(){this.currentInputState="none"}searchHandler(s){this.isSearching=s.detail.trim().length>0}paginationHandler(s){this.currentPage=s.detail}render(){return t(l,null,t("to4st-filter-modal",{isVisible:this.filterModalVisible,onClose:()=>this.filterModalVisible=!1,filters:this.filters}),t("to4st-edit-modal",{freeze:this.pendingRequest,currentError:this.currentError,currentItem:this.currentItem,currentInputState:this.currentInputState,columns:this.columns,onCloseErrorMessage:()=>this.currentError="",onClose:()=>{this.currentInputState="none",this.currentError=""},onChangeKeyValue:s=>this.changeValueCurrentItem(s.detail.key,s.detail.value),onDelete:()=>this.removeItem.emit(this.currentItem),onSave:()=>{this.pendingRequest=!0,this.saveItem.emit({transactionId:this.currentFormTransactionId,item:this.currentItem,isEdit:"edit"==this.currentInputState,afterSaveExecuted:this.afterSave})}}),t("div",{class:{"modal loadingModal":!0,"is-active":this.loadingInputBlock}},t("div",{class:"modal-background"}),t("div",{class:"modal-content"},t("figure",{class:"image container is-32x32"},t("img",{src:"https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/0.16.1/images/loader-large.gif",alt:"Loading ..."})))),t("article",{class:"message has-margin-top-30"},t("div",{class:"message-header"},t("p",null,this.name)),t("div",{class:"message-body"},t("div",{class:"level"},t("div",{class:"level-left"},t("div",{class:"field"},t("div",{class:{control:!0,"is-hidden":!this.hasCreate}},t("button",{class:"button is-success",onClick:()=>this.createItem()},t("i",{class:"fas fa-plus"}))))),t("div",{class:"level-right"},t("div",{class:{"field has-addons":!0,"is-hidden":!this.hasSearch||0===this.content.length&&!this.isSearching}},t("a",{class:{button:!0,"is-hidden":0===this.filters.length},onClick:()=>this.filterModalVisible=!0},t("i",{class:"fas fa-filter"})),t("p",{class:"control has-icons-right"},t("input",{type:"text",class:"input",placeholder:"Search",onKeyUp:s=>this.searchItem.emit(s.target.value.trim())}),t("span",{class:"icon is-small is-right"},t("i",{class:"fas fa-search"})))))),t("table",{class:{"table is-fullwidth is-hoverable":!0,"is-striped":this.striped,"is-hidden":this.content&&0==this.content.length&&!this.isSearching}},t("thead",null,this.columns.map((s=>!s.shouldBeVisible||s.shouldBeVisible()?t("th",{class:{"is-hidden-mobile":s.hiddenMobile&&s.hiddenMobile()}},s.name," ",s.sortable?t("a",{onClick:()=>{this.orderDesc=this.currentOrderBy!==s.name||!this.orderDesc,this.currentOrderBy=s.name,this.changedOrder.emit({orderBy:s.name,orderDesc:this.orderDesc})}},t("i",this.currentOrderBy!==s.name?{class:"fas fa-sort"}:this.orderDesc?{class:"fas fa-sort-up"}:{class:"fas fa-sort-down"})):""):"")),this.hasUpdate?t("th",null):""),t("tbody",null,this.content.map((s=>t("tr",{onClick:()=>{this.allowSelect&&(this.currentSelectedItem=s,this.itemSelected.emit(s))},class:{"is-selected":this.allowSelect&&this.currentSelectedItem===s}},this.columns.map((i=>!i.shouldBeVisible||i.shouldBeVisible()?t("td",{class:{"is-hidden-mobile":!!i.hiddenMobile}},i.tableContent(s)):"")),this.hasUpdate?t("td",null,t("div",{class:"level"},t("div",{class:"level-left"}),t("div",{class:"level-right"},t("div",{class:"field"},t("p",{class:"control"},t("a",{class:"button is-warning",onClick:()=>this.editItem(s)},t("i",{class:"fas is-small fa-edit"}))))))):""))))),t("div",{class:"level"},t("div",{class:"level-left"},t("a",{class:"button is-info is-hidden"},t("i",{class:"fas fa-cog"}))),t("div",{class:"level-right"},t("nav",{class:{"pagination is-right":!0,"is-hidden":!this.hasPagination||this.pagesCount<=1||0==this.content.length},role:"navigation","aria-label":"pagination"},t("ul",{class:"pagination-list"},t("li",null,t("a",{class:{"pagination-link":!0,"is-hidden":this.pagesCount<3||this.currentPage<3},onClick:()=>this.pagination.emit(1)},"1")),t("li",null,t("span",{class:{"pagination-ellipsis":!0,"is-hidden":this.pagesCount<3||this.currentPage<4}},"…")),t("li",null,t("a",{class:{"pagination-link":!0,"is-hidden":this.currentPage<2},onClick:()=>this.pagination.emit(this.currentPage-1)},this.currentPage-1)),t("li",null,t("a",{class:"pagination-link is-current"},this.currentPage)),t("li",null,t("a",{class:{"pagination-link":!0,"is-hidden":this.pagesCount<this.currentPage+1},onClick:()=>this.pagination.emit(this.currentPage+1)},this.currentPage+1)),t("li",null,t("span",{class:{"pagination-ellipsis":!0,"is-hidden":this.pagesCount<this.currentPage+3}},"…")),t("li",null,t("a",{class:{"pagination-link":!0,"is-hidden":this.pagesCount<this.currentPage+2},onClick:()=>this.pagination.emit(this.pagesCount)},this.pagesCount)))))))))}};e.style="to4st-list td{vertical-align:middle !important}.loadingModal{z-index:1 !important}";export{e as T,a as n}