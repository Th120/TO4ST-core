import{r as t,h as e,H as a}from"./p-88c3422c.js";import{G as s,a as i}from"./p-5a083649.js";import"./p-9ab228f4.js";import{e as n}from"./p-d397d124.js";import"./p-4127da2a.js";import"./p-0bc4f624.js";import"./p-50238e6f.js";const o=class{constructor(a){t(this,a),this.servers=[],this.currentPage=1,this.currentPageCount=1,this.currentSearch="",this.orderDesc=!0,this.apiClient={},this.columns=[{name:"Id",hiddenMobile:()=>!0,tableContent:t=>e("p",null,t.id)},{name:"Current Name",tableContent:t=>e("p",null,t.currentName),sortable:!0},{name:"Key",tableContent:t=>e("p",null,t.authKey),input:(t,a)=>{var s;return e("input",{type:"text",placeholder:"Leave blank to auto-generate",value:null!==(s=null==t?void 0:t.authKey)&&void 0!==s?s:"",class:"input",onChange:t=>a.emit({key:"authKey",value:t.target.value.trim()})})}},{name:"Description",tableContent:t=>e("p",null,t.description),input:(t,a)=>{var s;return e("input",{type:"text",placeholder:"Description",value:null!==(s=null==t?void 0:t.description)&&void 0!==s?s:"",class:"input",onChange:t=>a.emit({key:"description",value:t.target.value.trim()})})}},{name:"Last Contact",hiddenMobile:()=>!0,tableContent:t=>e("p",null,t.lastContact),sortable:!0}],this.filters=[]}async componentWillLoad(){await this.updateContent()}async updateContent(){try{const t=await this.apiClient.client.chain.query.gameservers({options:{pageSize:25,page:this.currentPage,search:this.currentSearch,orderDesc:this.orderDesc,orderBy:this.currentOrderBy}}).execute({pageCount:!0,content:{id:!0,authKey:!0,currentName:!0,description:!0,lastContact:!0}});this.servers=t.content,this.currentPageCount=t.pageCount}catch(t){console.error(t)}}async searchGameserver(t){this.currentSearch=t,await this.updateContent()}async saveGameserver(t,e,a,s){try{this.apiClient.setTransactionId(s),await this.apiClient.client.chain.mutation.createUpdateGameserver({gameserver:{id:t.id,authKey:t.authKey,description:t.description,currentName:t.currentName}}).execute({id:!1}),a.emit(),await this.updateContent()}catch(t){a.emit(n(t)),console.error(t)}}async goToPage(t){this.currentPage=t,await this.updateContent()}async removeGameserver(t){try{await this.apiClient.client.chain.mutation.deleteGameserver({gameserverId:t.id}).execute(!1),await this.updateContent()}catch(t){console.error(t)}}orderBy(t,e){this.orderDesc=e,this.currentOrderBy="Last Contact"===t?s.lastContact:s.currentName,this.updateContent()}render(){return e(a,null,e("to4st-list",{name:"Gameservers",columns:this.columns,content:this.servers,pagesCount:this.currentPageCount,currentPage:this.currentPage,onChangedOrder:t=>this.orderBy(t.detail.orderBy,t.detail.orderDesc),onPagination:t=>this.goToPage(t.detail),onSaveItem:t=>this.saveGameserver(t.detail.item,t.detail.isEdit,t.detail.afterSaveExecuted,t.detail.transactionId),onSearchItem:t=>this.searchGameserver(t.detail),onRemoveItem:t=>this.removeGameserver(t.detail)}))}};(function(t,e,a,s){var i,n=arguments.length,o=n<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,a):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,a,s);else for(var r=t.length-1;r>=0;r--)(i=t[r])&&(o=(n<3?i(o):n>3?i(e,a,o):i(e,a))||o);n>3&&o&&Object.defineProperty(e,a,o)})([i.Context("api")],o.prototype,"apiClient",void 0),o.style="";export{o as to4st_gameserver_list}