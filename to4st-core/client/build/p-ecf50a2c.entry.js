import{r as e,h as a,H as t}from"./p-d36259ec.js";import"./p-70b7bd16.js";import{G as n,a as l}from"./p-bc64f1f3.js";import"./p-0bc4f624.js";import{e as o}from"./p-6d473d66.js";import"./p-ad09e1f4.js";import"./p-63cac319.js";import"./p-50238e6f.js";var i=function(e,a,t,n){var l,o=arguments.length,i=o<3?a:null===n?n=Object.getOwnPropertyDescriptor(a,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,a,t,n);else for(var r=e.length-1;r>=0;r--)(l=e[r])&&(i=(o<3?l(i):o>3?l(a,t,i):l(a,t))||i);return o>3&&i&&Object.defineProperty(a,t,i),i};const r={currentName:"TO4 Gameserver",voteLength:25,gamePassword:"",reservedSlots:0,balanceClans:!0,allowSkipMapVote:!0,tempKickBanTime:30,autoRecordReplay:!1,playerGameControl:!1,enableMapVote:!0,serverAdmins:"",serverDescription:"",website:"",contact:"",mapNoReplay:3,enableVoicechat:!0},s=class{constructor(t){e(this,t),this.defaultGameserverConfig=r,this.columns=[{name:"Current Name",tableContent:e=>{var t;return a("p",null,null===(t=null==e?void 0:e.gameserver)||void 0===t?void 0:t.currentName)},detailInput:(e,t)=>{var n;return a("input",{type:"text",placeholder:"Current Name",value:null!==(n=null==e?void 0:e.currentName)&&void 0!==n?n:"",class:"input",onChange:e=>t("currentName",e.target.value.trim())})},sortable:!0},{name:"Id",tableContent:e=>{var t;return a("p",null,null===(t=null==e?void 0:e.gameserver)||void 0===t?void 0:t.id)},hiddenMobile:()=>!0},{name:"Has config",tableContent:e=>{var t;return a("p",null,this.getSymbol(!!(null===(t=null==e?void 0:e.gameserver)||void 0===t?void 0:t.gameserverConfig)))},hiddenMobile:()=>!0,sortable:()=>!0},{name:"Current Match Config",shouldBeVisible:()=>!1,detailInput:(e,t)=>a("div",{class:"select"},a("select",{onChange:e=>{var a;return t("currentMatchConfig",{id:null===(a=this.matchConfigs.find((a=>a.configName===e.target.value.trim())))||void 0===a?void 0:a.id})}},this.matchConfigs.map((t=>{var n;return a("option",{selected:(null===(n=null==e?void 0:e.currentMatchConfig)||void 0===n?void 0:n.configName)===t.configName},t.configName)}))))},{name:"Game Password",shouldBeVisible:()=>!1,detailInput:(e,t)=>{var n;return a("input",{type:"text",placeholder:"Game Password",value:null!==(n=null==e?void 0:e.gamePassword)&&void 0!==n?n:"",class:"input",onChange:e=>t("gamePassword",e.target.value.trim())})}},{name:"Reserved Slots",detailInput:(e,t)=>{var n;return a("input",{type:"number",placeholder:"Reserved slots",min:"0",max:"100",value:null!==(n=null==e?void 0:e.reservedSlots)&&void 0!==n?n:0,class:"input",onChange:e=>t("reservedSlots",parseInt(e.target.value))})},shouldBeVisible:()=>!1},{name:"Balance Clans",detailInput:(e,t)=>a("to4st-switch",{value:null==e?void 0:e.balanceClans,onToggle:e=>t("balanceClans",e.detail)}),shouldBeVisible:()=>!1},{name:"Allow Skip Mapvote",detailInput:(e,t)=>a("to4st-switch",{value:null==e?void 0:e.allowSkipMapVote,onToggle:e=>t("allowSkipMapVote",e.detail)}),shouldBeVisible:()=>!1},{name:"Temp Kick Ban Time",detailInput:(e,t)=>{var n;return a("input",{type:"number",placeholder:"Temp Kick Ban Time",min:"1",value:null!==(n=null==e?void 0:e.tempKickBanTime)&&void 0!==n?n:0,class:"input",onChange:e=>t("tempKickBanTime",parseInt(e.target.value))})},shouldBeVisible:()=>!1},{name:"Auto Record Replay",detailInput:(e,t)=>a("to4st-switch",{value:null==e?void 0:e.autoRecordReplay,onToggle:e=>t("autoRecordReplay",e.detail)}),shouldBeVisible:()=>!1},{name:"Player Game Control",detailInput:(e,t)=>a("to4st-switch",{value:null==e?void 0:e.playerGameControl,onToggle:e=>t("playerGameControl",e.detail)}),shouldBeVisible:()=>!1,tooltip:()=>"Players can vote for match actions (reset, map change, pause)"},{name:"Enable Mapvote",detailInput:(e,t)=>a("to4st-switch",{value:null==e?void 0:e.enableMapVote,onToggle:e=>t("enableMapVote",e.detail)}),shouldBeVisible:()=>!1},{name:"Vote Length",detailInput:(e,t)=>{var n;return a("input",{type:"number",placeholder:"Vote Length",min:"5",value:null!==(n=null==e?void 0:e.voteLength)&&void 0!==n?n:0,class:"input",onChange:e=>t("voteLength",parseInt(e.target.value))})},shouldBeVisible:()=>!1},{name:"Server Admins",detailInput:(e,t)=>{var n;return a("input",{type:"text",placeholder:"Server Admins",value:null!==(n=null==e?void 0:e.serverAdmins)&&void 0!==n?n:"",class:"input",onChange:e=>t("serverAdmins",e.target.value.trim())})},shouldBeVisible:()=>!1},{name:"Server Description",detailInput:(e,t)=>{var n;return a("input",{type:"text",placeholder:"Server Description",value:null!==(n=null==e?void 0:e.serverDescription)&&void 0!==n?n:"",class:"input",onChange:e=>t("serverDescription",e.target.value.trim())})},shouldBeVisible:()=>!1},{name:"Website",detailInput:(e,t)=>{var n;return a("input",{type:"text",placeholder:"Website",value:null!==(n=null==e?void 0:e.website)&&void 0!==n?n:"",class:"input",onChange:e=>t("website",e.target.value.trim())})},shouldBeVisible:()=>!1},{name:"Contact",detailInput:(e,t)=>{var n;return a("input",{type:"text",placeholder:"Contact",value:null!==(n=null==e?void 0:e.contact)&&void 0!==n?n:"",class:"input",onChange:e=>t("contact",e.target.value.trim())})},shouldBeVisible:()=>!1},{name:"Map No Replay",detailInput:(e,t)=>{var n;return a("input",{type:"number",placeholder:"Map No Replay",min:"0",max:"30",value:null!==(n=null==e?void 0:e.mapNoReplay)&&void 0!==n?n:0,class:"input",onChange:e=>t("warmUpLength",parseInt(e.target.value))})},shouldBeVisible:()=>!1,tooltip:()=>"A map can't be voted for the given count of map switches"},{name:"Enable Voicechat",detailInput:(e,t)=>a("to4st-switch",{value:null==e?void 0:e.enableVoicechat,onToggle:e=>t("enableVoicechat",e.detail)}),shouldBeVisible:()=>!1}]}onMatchConfigsUpdated(){void 0!==this.matchConfigs&&(!this.defaultGameserverConfig.currentMatchConfig&&this.matchConfigs.length>0&&(this.defaultGameserverConfig.currentMatchConfig=this.matchConfigs[0]),this.columns=[...this.columns])}async saveGameserverConfig(e,a,t){const n=e;try{this.apiClient.setTransactionId(a),await this.apiClient.client.chain.mutation.createUpdateGameserverConfig({gameserverConfig:{gameserverId:n.gameserver.id,currentMatchConfigId:n.currentMatchConfig.id,currentGameserverName:n.currentName,voteLength:n.voteLength,tempKickBanTime:n.tempKickBanTime,gamePassword:n.gamePassword,serverAdmins:n.serverAdmins,serverDescription:n.serverDescription,website:n.website,contact:n.contact,reservedSlots:n.reservedSlots,mapNoReplay:n.mapNoReplay,balanceClans:n.balanceClans,allowSkipMapVote:n.allowSkipMapVote,autoRecordReplay:n.autoRecordReplay,playerGameControl:n.playerGameControl,enableMapVote:n.enableMapVote,enableVoicechat:n.enableVoicechat}}).execute({gameserver:{id:!0}}),t.emit("")}catch(e){t.emit(o(e)),console.error(e)}}getSymbol(e){return a("i",e?{class:"fas fa-check"}:{class:"fas fa-times"})}async removeGameserverConfig(e,a){const t=e;try{await this.apiClient.client.chain.mutation.deleteGameserverConfig({gameserverId:t.gameserver.id}).execute(!1)}catch(e){console.error(e)}a()}async updateGameserverConfigs(e,a,t,l,o){try{const i=await this.apiClient.client.chain.query.gameservers({options:{pageSize:15,page:e,search:a,orderDesc:l,orderBy:t||n.hasConfig}}).execute({pageCount:!0,content:{id:!0,currentName:!0,gameserverConfig:{currentMatchConfig:{id:!0,configName:!0,gameMode:{name:!0},configHash:!0,matchEndLength:!0,warmUpLength:!0,friendlyFireScale:!0,mapLength:!0,roundLength:!0,preRoundLength:!0,roundEndLength:!0,roundLimit:!0,allowGhostcam:!0,playerVoteThreshold:!0,autoBalanceTeams:!0,playerVoteTeamOnly:!0,maxTeamDamage:!0,enablePlayerVote:!0,autoSwapTeams:!0,midGameBreakLength:!0,nadeRestriction:!0,globalVoicechat:!0,muteDeadToTeam:!0,ranked:!0,private:!0},currentName:!0,voteLength:!0,gamePassword:!0,reservedSlots:!0,balanceClans:!0,allowSkipMapVote:!0,tempKickBanTime:!0,autoRecordReplay:!0,playerGameControl:!0,enableMapVote:!0,serverAdmins:!0,serverDescription:!0,website:!0,contact:!0,mapNoReplay:!0,enableVoicechat:!0}}});o(i.content.map((e=>{if(e.gameserverConfig)return e.gameserverConfig.gameserver=e,e.gameserverConfig;const a=Object.assign({},r);return a.gameserver=e,a})),i.pageCount)}catch(e){console.error(e),o([],1)}}render(){return a(t,null,a("to4st-details",{name:"Gameservers",columns:this.columns,hasSearch:!0,defaultCreateObject:this.defaultGameserverConfig,mapOrderByAssign:e=>"Current Name"===e?n.currentName:n.hasConfig,canItemBeDeleted:e=>{var a;return!!(null===(a=null==e?void 0:e.gameserver)||void 0===a?void 0:a.gameserverConfig)},onUpdateEntities:e=>this.updateGameserverConfigs(e.detail.page,e.detail.search,e.detail.orderBy,e.detail.orderDesc,e.detail.onFetchedData),onSaveEntity:e=>this.saveGameserverConfig(e.detail.entity,e.detail.transactionId,e.detail.afterEx),onDeleteEntity:e=>this.removeGameserverConfig(e.detail.entity,e.detail.onDeletedEntity)}))}};i([l.Context("api")],s.prototype,"apiClient",void 0),i([l.Context("matchConfigs")],s.prototype,"matchConfigs",void 0),i([l.Observe("matchConfigs")],s.prototype,"onMatchConfigsUpdated",null),s.style="";var u=function(e,a,t,n){var l,o=arguments.length,i=o<3?a:null===n?n=Object.getOwnPropertyDescriptor(a,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,a,t,n);else for(var r=e.length-1;r>=0;r--)(l=e[r])&&(i=(o<3?l(i):o>3?l(a,t,i):l(a,t))||i);return o>3&&i&&Object.defineProperty(a,t,i),i},d=function(e,a){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&a.indexOf(n)<0&&(t[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var l=0;for(n=Object.getOwnPropertySymbols(e);l<n.length;l++)a.indexOf(n[l])<0&&Object.prototype.propertyIsEnumerable.call(e,n[l])&&(t[n[l]]=e[n[l]])}return t};const p={gameMode:{name:"Classic"},matchEndLength:10,warmUpLength:30,friendlyFireScale:20,mapLength:20,roundLength:180,preRoundLength:6,roundEndLength:5,roundLimit:24,allowGhostcam:!0,playerVoteThreshold:60,autoBalanceTeams:!0,playerVoteTeamOnly:!1,maxTeamDamage:520,enablePlayerVote:!0,autoSwapTeams:!1,midGameBreakLength:0,nadeRestriction:!0,globalVoicechat:!1,muteDeadToTeam:!1,ranked:!1,private:!1},c=class{constructor(t){e(this,t),this.gameModes=[],this.columns=[{name:"Id",tableContent:e=>a("p",null,null==e?void 0:e.id)},{name:"Config Name",tableContent:e=>a("p",null,null==e?void 0:e.configName),detailInput:(e,t)=>{var n;return a("input",{type:"text",placeholder:"Config Name",value:null!==(n=null==e?void 0:e.configName)&&void 0!==n?n:"",class:"input",onChange:e=>t("configName",e.target.value.trim())})},input:(e,t)=>{var n;return a("input",{type:"text",placeholder:"Config Name",value:null!==(n=null==e?void 0:e.configName)&&void 0!==n?n:"",class:"input",onChange:e=>t.emit({key:"configName",value:e.target.value.trim()})})},sortable:!0},{name:"Game Mode",tableContent:e=>{var t;return a("p",null,null===(t=null==e?void 0:e.gameMode)||void 0===t?void 0:t.name)},detailInput:(e,t)=>a("div",{class:"select"},a("select",{onChange:e=>t("gameMode",{name:e.target.value.trim()})},this.gameModes.map((t=>{var n;return a("option",{selected:(null===(n=null==e?void 0:e.gameMode)||void 0===n?void 0:n.name)===t.name},t.name)}))))},{name:"Config Hash",tableContent:e=>a("p",null,null==e?void 0:e.configHash),hiddenMobile:()=>!0},{name:"Matchend Length",shouldBeVisible:()=>!1,detailInput:(e,t)=>{var n;return a("input",{type:"number",placeholder:"Matchend Length",min:"1",max:"60",value:null!==(n=null==e?void 0:e.matchEndLength)&&void 0!==n?n:0,class:"input",onChange:e=>t("matchendLength",parseInt(e.target.value))})}},{name:"Warm Up Length",shouldBeVisible:()=>!1,detailInput:(e,t)=>{var n;return a("input",{type:"number",placeholder:"Warm Up Length",min:"1",max:"300",value:null!==(n=null==e?void 0:e.warmUpLength)&&void 0!==n?n:0,class:"input",onChange:e=>t("warmUpLength",parseInt(e.target.value))})}},{name:"Friendly Fire Scale",shouldBeVisible:()=>!1,detailInput:(e,t)=>{var n;return a("input",{type:"number",placeholder:"Friendly Fire Scale",min:"0",max:"100",step:"0.5",value:null!==(n=null==e?void 0:e.friendlyFireScale)&&void 0!==n?n:0,class:"input",onChange:e=>t("friendlyFireScale",parseFloat(e.target.value))})}},{name:"Map Length",shouldBeVisible:()=>!1,detailInput:(e,t)=>{var n;return a("input",{type:"number",placeholder:"Map Length",min:"1",max:"99",value:null!==(n=null==e?void 0:e.mapLength)&&void 0!==n?n:0,class:"input",onChange:e=>t("warmUpLength",parseInt(e.target.value))})}},{name:"Round Length",shouldBeVisible:()=>!1,detailInput:(e,t)=>{var n;return a("input",{type:"number",placeholder:"Round Length",min:"1",max:"3599",value:null!==(n=null==e?void 0:e.roundLength)&&void 0!==n?n:0,class:"input",onChange:e=>t("roundLength",parseInt(e.target.value))})}},{name:"Pre Round Length",shouldBeVisible:()=>!1,detailInput:(e,t)=>{var n;return a("input",{type:"number",placeholder:"Pre Round Length",min:"1",max:"20",value:null!==(n=null==e?void 0:e.preRoundLength)&&void 0!==n?n:0,class:"input",onChange:e=>t("preRoundLength",parseInt(e.target.value))})}},{name:"Round End Length",shouldBeVisible:()=>!1,detailInput:(e,t)=>{var n;return a("input",{type:"number",placeholder:"Round End Length",min:"1",max:"20",value:null!==(n=null==e?void 0:e.roundEndLength)&&void 0!==n?n:0,class:"input",onChange:e=>t("roundEndLength",parseInt(e.target.value))})}},{name:"Round Limit",shouldBeVisible:()=>!1,detailInput:(e,t)=>{var n;return a("input",{type:"number",placeholder:"Round Limit",min:"0",max:"99",value:null!==(n=null==e?void 0:e.roundLimit)&&void 0!==n?n:0,class:"input",onChange:e=>t("roundLimit",parseInt(e.target.value))})}},{name:"Allow Ghostcam",shouldBeVisible:()=>!1,detailInput:(e,t)=>a("to4st-switch",{value:null==e?void 0:e.allowGhostcam,onToggle:e=>t("allowGhostcam",e.detail)})},{name:"Player Vote Threshold",shouldBeVisible:()=>!1,detailInput:(e,t)=>{var n;return a("input",{type:"number",min:"0",max:"100",step:"0.5",placeholder:"Friendly Fire Scale",value:null!==(n=null==e?void 0:e.playerVoteThreshold)&&void 0!==n?n:0,class:"input",onChange:e=>t("playerVoteThreshold",parseFloat(e.target.value))})}},{name:"Auto Balance Teams",detailInput:(e,t)=>a("to4st-switch",{value:null==e?void 0:e.autoBalanceTeams,onToggle:e=>t("autoBalanceTeams",e.detail)}),shouldBeVisible:()=>!1,tooltip:()=>"Swaps players automatically to keep teams even"},{name:"Player Vote Team Only",detailInput:(e,t)=>a("to4st-switch",{value:null==e?void 0:e.playerVoteTeamOnly,onToggle:e=>t("playerVoteTeamOnly",e.detail)}),shouldBeVisible:()=>!1},{name:"Max Team Damage",detailInput:(e,t)=>{var n;return a("input",{type:"number",placeholder:"Max Team Damage",min:"0",max:"99999",value:null!==(n=null==e?void 0:e.maxTeamDamage)&&void 0!==n?n:0,class:"input",onChange:e=>t("maxTeamDamage",parseInt(e.target.value))})},shouldBeVisible:()=>!1},{name:"Enable Player Vote",shouldBeVisible:()=>!1,detailInput:(e,t)=>a("to4st-switch",{value:null==e?void 0:e.enablePlayerVote,onToggle:e=>t("enablePlayerVote",e.detail)}),tooltip:()=>"Players can vote other players out"},{name:"Auto Swap Teams",shouldBeVisible:()=>!1,detailInput:(e,t)=>a("to4st-switch",{value:null==e?void 0:e.autoSwapTeams,onToggle:e=>t("autoSwapTeams",e.detail)}),tooltip:()=>"If a roundlimit is used the players swap teams after half of the rounds"},{name:"Mid Game Break Length",shouldBeVisible:()=>!1,detailInput:(e,t)=>{var n;return a("input",{type:"number",placeholder:"Mid Game Break Length",min:"0",max:"300",value:null!==(n=null==e?void 0:e.midGameBreakLength)&&void 0!==n?n:0,class:"input",onChange:e=>t("midGameBreakLength",parseInt(e.target.value))})},tooltip:()=>"If a roundlimit is used the game pauses for given seconds when half of the rounds are over"},{name:"Nade Restriction",shouldBeVisible:()=>!1,detailInput:(e,t)=>a("to4st-switch",{value:null==e?void 0:e.nadeRestriction,onToggle:e=>t("nadeRestriction",e.detail)}),tooltip:()=>"Only one nade of each kind can be bought at round begin"},{name:"Global Voicechat",shouldBeVisible:()=>!1,detailInput:(e,t)=>a("to4st-switch",{value:null==e?void 0:e.globalVoicechat,onToggle:e=>t("globalVoicechat",e.detail)})},{name:"Mute Dead To Team",shouldBeVisible:()=>!1,detailInput:(e,t)=>a("to4st-switch",{value:null==e?void 0:e.muteDeadToTeam,onToggle:e=>t("muteDeadToTeam",e.detail)})},{name:"Ranked",shouldBeVisible:()=>!1,detailInput:(e,t)=>a("to4st-switch",{value:null==e?void 0:e.ranked,onToggle:e=>t("ranked",e.detail)}),tooltip:()=>"Allows to seperate ranked / unranked player stats"},{name:"Private",shouldBeVisible:()=>!1,detailInput:(e,t)=>a("to4st-switch",{value:null==e?void 0:e.private,onToggle:e=>t("private",e.detail)}),tooltip:()=>"Server requires password or reserved slot access"}]}async componentWillLoad(){(async()=>{const e=await this.apiClient.client.chain.query.gameModes.execute({pageCount:!0,content:{name:!0}});this.gameModes=e.content})().catch((e=>console.error("error while loading gameModes",e)))}async saveMatchConfig(e,a,t){let n=e;n.id||(n=Object.assign(Object.assign({},n),p));try{this.apiClient.setTransactionId(a),await this.apiClient.client.chain.mutation.createUpdateMatchConfig({matchConfig:{id:n.id,configName:n.configName,gameMode:{name:n.gameMode.name},matchEndLength:n.matchEndLength,warmUpLength:n.warmUpLength,friendlyFireScale:n.friendlyFireScale,mapLength:n.mapLength,roundLength:n.roundLength,preRoundLength:n.preRoundLength,roundEndLength:n.roundEndLength,roundLimit:n.roundLimit,allowGhostcam:n.allowGhostcam,playerVoteThreshold:n.playerVoteThreshold,autoBalanceTeams:n.autoBalanceTeams,playerVoteTeamOnly:n.playerVoteTeamOnly,maxTeamDamage:n.maxTeamDamage,enablePlayerVote:n.enablePlayerVote,autoSwapTeams:n.autoSwapTeams,midGameBreakLength:n.midGameBreakLength,nadeRestriction:n.nadeRestriction,globalVoicechat:n.globalVoicechat,muteDeadToTeam:n.muteDeadToTeam,ranked:n.ranked,private:n.private}}).execute({id:!1}),t.emit("")}catch(e){t.emit(o(e)),console.error(e)}}async removeMatchConfig(e,a){const t=e;try{await this.apiClient.client.chain.mutation.deleteMatchConfig({options:{id:t.id}}).execute(!1)}catch(e){console.error(e)}a()}async updateMatchConfigs(e,a,t,n,l){try{const t=await this.apiClient.client.chain.query.matchConfigs({options:{page:e,pageSize:15,configName:a,orderDesc:n}}).execute({pageCount:!0,content:{id:!0,configName:!0,gameMode:{name:!0},configHash:!0,matchEndLength:!0,warmUpLength:!0,friendlyFireScale:!0,mapLength:!0,roundLength:!0,preRoundLength:!0,roundEndLength:!0,roundLimit:!0,allowGhostcam:!0,playerVoteThreshold:!0,autoBalanceTeams:!0,playerVoteTeamOnly:!0,maxTeamDamage:!0,enablePlayerVote:!0,autoSwapTeams:!0,midGameBreakLength:!0,nadeRestriction:!0,globalVoicechat:!0,muteDeadToTeam:!0,ranked:!0,private:!0}});this.matchConfigs=t.content,l(t.content,t.pageCount)}catch(e){console.error(e),l([],1)}}render(){return a(t,null,a("to4st-details",{name:"Match Configs",columns:this.columns,hasSearch:!0,mapPreSerializeEntity:e=>({mapped:d(e,["id"]),fileName:e.configName}),useDefaultListCreate:!0,onUpdateEntities:e=>this.updateMatchConfigs(e.detail.page,e.detail.search,e.detail.orderBy,e.detail.orderDesc,e.detail.onFetchedData),onSaveEntity:e=>this.saveMatchConfig(e.detail.entity,e.detail.transactionId,e.detail.afterEx),onDeleteEntity:e=>this.removeMatchConfig(e.detail.entity,e.detail.onDeletedEntity)}))}};u([l.Context("api")],c.prototype,"apiClient",void 0),u([l.Context("matchConfigs")],c.prototype,"matchConfigs",void 0),c.style="";export{s as to4st_gameserver_config_list,c as to4st_match_config_list}